@page "/"
@page "/index"
@inject UserProfileService UserSvc
@inject AppState AppState
<PageTitle>Babaturan - Tempat bersosial yang sehat dan menyenangkan</PageTitle>
<main>

  <!-- Container START -->
  <div class="container">
    <div class="row g-4">

      <!-- Sidenav START -->
      <SideNavPage></SideNavPage>
      <!-- Sidenav END -->

      <!-- Main content START -->
      <div class="col-md-8 col-lg-6 vstack gap-4">
        <!-- Story START -->
        <div class="tiny-slider arrow-hover overflow-hidden">
          <div class="tiny-slider-inner ms-n4" data-arrow="true" data-dots="true" data-loop="false" data-autoplay="false" data-items-xl="4" data-items-lg="3" data-items-md="3" data-items-sm="3" data-items-xs="2" data-gutter="12" data-edge="30">

            <!-- Slider items -->
            <div>
              <!-- Card add story START -->
              <div class="card border border-2 border-dashed h-150px shadow-none d-flex align-items-center justify-content-center text-center">
                <div>
                  <a class="stretched-link btn btn-light rounded-circle icon-md" href="#!"><i class="fa-solid fa-plus"></i></a>
                  <h6 class="mt-2 mb-0 small">Post a Story</h6>
                </div>
              </div>
              <!-- Card add story END -->
            </div>

            <!-- Slider items -->
            <div>
              <!-- Card START -->
              <div class="card card-overlay-bottom border-0 position-relative h-150px" style="background-image:url(assets/images/post/1by1/02.jpg); background-position: center left; background-size: cover;">
                <div class="card-img-overlay d-flex align-items-center p-2">
                  <div class="w-100 mt-auto">
                    <!-- Name -->
                    <a href="#!" class="stretched-link text-white small">Judy Nguyen</a>
                  </div>
                </div>
              </div>
              <!-- Card END -->
            </div>

            <!-- Slider items -->
            <div>
              <!-- Card START -->
              <div class="card card-overlay-bottom border-0 position-relative h-150px" style="background-image:url(assets/images/post/1by1/03.jpg); background-position: center left; background-size: cover;">
                <div class="card-img-overlay d-flex align-items-center p-2">
                  <div class="w-100 mt-auto">
                    <!-- Name -->
                    <a href="#!" class="stretched-link text-white small">Samuel Bishop</a>
                  </div>
                </div>
              </div>
              <!-- Card END -->
            </div>

            <!-- Slider items -->
            <div>
              <!-- Card START -->
              <div class="card card-overlay-bottom border-0 position-relative h-150px" style="background-image:url(assets/images/post/1by1/04.jpg); background-position: center left; background-size: cover;">
                <div class="card-img-overlay d-flex align-items-center p-2">
                  <div class="w-100 mt-auto">
                    <!-- Name -->
                    <a href="#!" class="stretched-link text-white small">Carolyn Ortiz</a>
                  </div>
                </div>
              </div>
              <!-- Card END -->
            </div>

            <!-- Slider items -->
            <div>
              <!-- Card START -->
              <div class="card card-overlay-bottom border-0 position-relative h-150px" style="background-image:url(assets/images/post/1by1/05.jpg); background-position: center left; background-size: cover;">
                <div class="card-img-overlay d-flex align-items-center p-2">
                  <div class="w-100 mt-auto">
                    <!-- Name -->
                    <a href="#!" class="stretched-link text-white small">Amanda Reed</a>
                  </div>
                </div>
              </div>
              <!-- Card END -->
            </div>

            <!-- Slider items -->
            <div>
              <!-- Card START -->
              <div class="card card-overlay-bottom border-0 position-relative h-150px" style="background-image:url(assets/images/post/1by1/01.jpg); background-position: center left; background-size: cover;">
                <div class="card-img-overlay d-flex align-items-center p-2">
                  <div class="w-100 mt-auto">
                    <!-- Name -->
                    <a href="#!" class="stretched-link text-white small">Lori Stevens</a>
                  </div>
                </div>
              </div>
              <!-- Card END -->
            </div>
          </div>
        </div>
        <!-- Story END -->

        <!-- Share feed START -->
        <div class="card card-body">
          <div class="d-flex mb-3">
            <!-- Avatar -->
            <div class="avatar avatar-xs me-2">
              <a href="#"> <img class="avatar-img rounded-circle" src="@(string.IsNullOrEmpty(SelUser.PicUrl)?"assets/images/avatar/03.jpg":SelUser.PicUrl)" alt=""> </a>
            </div>
            <!-- Post input -->
            <form class="w-100">
              <textarea class="form-control pe-4 border-0" rows="2" data-autoresize placeholder="Share your thoughts..." data-bs-toggle="modal" data-bs-target="#modalCreateFeed"></textarea>
            </form>
          </div>
          <!-- Share feed toolbar START -->
          <ul class="nav nav-pills nav-stack small fw-normal">
            <li class="nav-item">
              <a class="nav-link bg-light py-1 px-2 mb-0" href="#!" data-bs-toggle="modal" data-bs-target="#feedActionPhoto"> <i class="bi bi-image-fill text-success pe-2"></i>Photo</a>
            </li>
            <li class="nav-item">
              <a class="nav-link bg-light py-1 px-2 mb-0" href="#!" data-bs-toggle="modal" data-bs-target="#feedActionVideo"> <i class="bi bi-camera-reels-fill text-info pe-2"></i>Video</a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link bg-light py-1 px-2 mb-0" data-bs-toggle="modal" data-bs-target="#modalCreateEvents"> <i class="bi bi-calendar2-event-fill text-danger pe-2"></i>Event </a>
            </li>
            <li class="nav-item">
              <a class="nav-link bg-light py-1 px-2 mb-0" href="#!" @onclick="CreateNewPost" data-bs-toggle="modal" data-bs-target="#modalCreateFeed"> <i class="bi bi-emoji-smile-fill text-warning pe-2"></i>Feeling /Activity</a>
            </li>
            <li class="nav-item dropdown ms-lg-auto">
              <a class="nav-link bg-light py-1 px-2 mb-0" href="#" id="feedActionShare" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-three-dots"></i>
              </a>
              <!-- Dropdown menu -->
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="feedActionShare">
                <li><a class="dropdown-item" href="#"> <i class="bi bi-envelope fa-fw pe-2"></i>Create a poll</a></li>
                <li><a class="dropdown-item" href="#"> <i class="bi bi-bookmark-check fa-fw pe-2"></i>Ask a question </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="#"> <i class="bi bi-pencil-square fa-fw pe-2"></i>Help</a></li>
              </ul>
            </li>
          </ul>
          <!-- Share feed toolbar END -->
        </div>
        <!-- Share feed END -->
        <ListPostPage UserName="@SelUser.Username"></ListPostPage>
        <!-- Card Feed Item Samples -->
          <!-- Load more button START -->
          <a href="#!" role="button" class="btn btn-loader btn-primary-soft" data-bs-toggle="button" aria-pressed="true">
            <span class="load-text"> Load more </span>
            <div class="load-icon">
              <div class="spinner-grow spinner-grow-sm" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </a>
          <!-- Load more button END -->

      </div>
      <!-- Main content END -->

      <!-- Right sidebar START -->
      <div class="col-lg-3">
        <div class="row g-4">
          <!-- Card follow START -->
          <WhoToFollowPage></WhoToFollowPage>
          <!-- Card follow START -->

          <!-- Card News START -->
         <NewsCardPage></NewsCardPage>
          <!-- Card News END -->
        </div>
      </div>
      <!-- Right sidebar END -->

    </div> <!-- Row END -->
  </div>
  <!-- Container END -->

</main>
@code {
    int Tahun = DateHelper.GetLocalTimeNow().Year;

    public UserProfile SelUser { get; set; }
    string UserName { set; get; }
    [CascadingParameter]
    private Task<AuthenticationState> authenticationStateTask { get; set; }
  
    bool HasLogin = false;
    protected override async Task OnInitializedAsync()
    {

        var user = (await authenticationStateTask).User;

        if (user.Identity.IsAuthenticated)
        {
            UserName = user.Identity.Name;
            SelUser = UserSvc.GetItemByUsernameFull(UserName);
            HasLogin = true;
        }
        
    }

    async Task CreateNewPost()
{
        AppState.CreateNewPost(SelUser.Username);
}
}
